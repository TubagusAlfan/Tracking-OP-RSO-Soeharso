<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>ortojejak</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <link
      href="assets/img/Logo_RSO_Soeharso_Surakarta-removebg-preview.png"
      rel="icon"
    />
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <link
      href="assets/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="assets/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/aos/aos.css" rel="stylesheet" />
    <link
      href="assets/vendor/glightbox/css/glightbox.min.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

    <link href="assets/css/main.css" rel="stylesheet" />

    <style>
      /* Tambahan khusus pemusatan list Misi */
      .mission-wrapper {
        display: flex;
        justify-content: center;
        width: 100%;
      }
      .mission-list {
        list-style: none;
        max-width: 780px;
        margin: 0;
        padding: 0 1rem;
      }
      .mission-list li {
        position: relative;
        padding-left: 1.1rem;
        margin-bottom: 0.35rem;
        line-height: 1.35;
      }
      .mission-list li::before {
        content: "â€¢";
        position: absolute;
        left: 0;
        top: 0;
        line-height: 1.35;
        font-weight: 600;
      }
      /* CSS untuk catalog ortotik prostetik */
      .op-catalog {
        margin-top: 1rem;
        display: grid;
        border: 1px solid #e5e5e5;
        background: #fff;
        grid-template-columns: 1fr;
      }
      @media (min-width: 900px) {
        .op-catalog {
          grid-template-columns: repeat(3, 1fr);
        }
      }
      .op-cat-col {
        border-right: 1px solid #e5e5e5;
      }
      .op-cat-col:last-child {
        border-right: none;
      }
      .op-cat-head {
        padding: 0.65rem 0.9rem;
        font-weight: 600;
        color: #fff;
        font-style: italic;
      }
      .head-lower {
        background: #2e2927;
      }
      .head-upper {
        background: #0a5d62;
      }
      .head-spinal {
        background: #c84f00;
      }
      .op-cat-list {
        list-style: none;
        margin: 0;
        padding: 0.7rem 0.9rem 1rem;
      }
      .op-cat-list li {
        display: flex;
        gap: 0.45rem;
        line-height: 1.2;
        margin-bottom: 0.45rem;
      }
      .op-cat-list li i {
        color: #008c8c;
        line-height: 1.2;
        margin-top: 2px;
        font-size: 0.95rem;
      }
    </style>
  </head>

  <body class="index-page">
    <header id="header" class="header d-flex align-items-center fixed-top">
      <div
        class="container-fluid container-xl position-relative d-flex align-items-center justify-content-between"
      >
        <a href="../login.html" class="logo d-flex align-items-center">
          <img
            src="assets/img/Logo RSO Baru.png"
            alt="Logo RSO"
            class="me-2"
            style="height: 32px; width: auto"
          />
          <h1 class="sitename m-0">ORTOJEJAK</h1>
        </a>

        <nav id="navmenu" class="navmenu">
          <ul>
            <li><a href="#hero" class="active">Beranda</a></li>
            <li><a href="#about">Tentang</a></li>
            <li><a href="#services">Layanan</a></li>
            <li><a href="#portfolio">Produk</a></li>
            <li><a href="#team">Tim</a></li>
            <li><a href="#contact">Kontak</a></li>
          </ul>
          <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
        </nav>
      </div>
    </header>

    <main class="main">
      <section id="hero" class="hero section dark-background">
        <div
          id="hero-carousel"
          class="carousel slide carousel-fade"
          data-bs-ride="carousel"
          data-bs-interval="5000"
        >
          <div class="carousel-item active">
            <img
              src="assets/img/hero-carousel/latar-belakang-rso-1.jpg"
              alt=""
            />
            <div class="carousel-container">
              <h2>Selamat Datang di ORTOJEJAK</h2>
              <p>
                Website ini adalah portal pelacakan progres pengerjaan alat
                ortotik/prostetik yang memudahkan pasien memantau setiap tahapan
                secara real-time.
              </p>
              <form
                id="regTrackForm"
                class="d-flex flex-column align-items-center mt-4"
                onsubmit="return trackByReg(event)"
              >
                <div class="input-group" style="max-width: 650px">
                  <input
                    id="regSearchInput"
                    type="text"
                    class="form-control"
                    placeholder="Masukkan No. Order untuk Lacak Progres..."
                    aria-label="No. Order"
                    required
                  />
                  <button class="btn btn-outline-info" type="submit">
                    Lacak
                  </button>
                </div>

                <div id="recaptcha-container" class="mt-3"></div>
                <div id="recaptcha-error" class="text-danger small mt-2" style="display:none"></div>

              </form>
              <div
                id="track-error"
                class="text-warning fw-semibold mt-2"
                style="display: none; font-size: 0.9rem"
              ></div>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="assets/img/hero-carousel/latar-belakang-rso-2.jpg"
              alt=""
            />
            <div class="carousel-container">
              <h2>Visi</h2>
              <p class="text-center">
                "Menjadi Rumah Sakit Ortopedi Unggulan dengan Pelayanan Prima"
              </p>
              <a href="../login.html" class="btn-get-started"
                >Daftar Sekarang</a
              >
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="assets/img/hero-carousel/latar-belakang-rso-3.jpg"
              alt=""
            />
            <div class="carousel-container">
              <h2>Misi</h2>
              <div class="mission-wrapper">
                <ul class="mission-list">
                  <li>
                    Mewujudkan pelayanan sub spesialitastik ortopedi
                    traumatologi terintegrasi pendidikan dan pelatihan secara
                    paripurna.
                  </li>
                  <li>
                    Mewujudkan manajemen rumah sakit dengan kaidah bisnis yang
                    sehat, efektif, efisien dan akuntabel.
                  </li>
                  <li>
                    Mewujudkan Sumber Daya Manusia (SDM) yang profesional,
                    inovatif, kreatif dan ber-AKHLAK (Berorientasi Pelayanan,
                    Akuntabel, Kompeten, Harmonis, Loyal, Adaptif, Kolaboratif).
                  </li>
                  <li>
                    Mewujudkan jejaring pelayanan yang komprehensif dan
                    berkelanjutan.
                  </li>
                </ul>
              </div>
              <a href="../login.html" class="btn-get-started"
                >Daftar Sekarang</a
              >
            </div>
          </div>
          <a
            class="carousel-control-prev"
            href="#hero-carousel"
            role="button"
            data-bs-slide="prev"
          >
            <span
              class="carousel-control-prev-icon bi bi-chevron-left"
              aria-hidden="true"
            ></span>
          </a>

          <a
            class="carousel-control-next"
            href="#hero-carousel"
            role="button"
            data-bs-slide="next"
          >
            <span
              class="carousel-control-next-icon bi bi-chevron-right"
              aria-hidden="true"
            ></span>
          </a>

          <ol class="carousel-indicators"></ol>
        </div>
      </section>
      <section id="about" class="about section">
        <div class="container section-title" data-aos="fade-up">
          <h2>Tentang</h2>
          <p>Ortotik Prostetik RSO Soeharso Surakarta</p>
        </div>
        <div class="container">
          <div class="row gy-4">
            <div
              class="col-lg-6 order-1 order-lg-2"
              data-aos="fade-up"
              data-aos-delay="100"
            >
              <img src="assets/img/bengkel.jpg" class="img-fluid" alt="" />
            </div>

            <div
              class="col-lg-6 order-2 order-lg-1 content"
              data-aos="fade-up"
              data-aos-delay="200"
            >
              <h3>Ortotik Prostetik</h3>
              <p class="fst-italic">
                Ortotik Prostetik adalah salah satu pelayanan kesehatan untuk
                pembuatan dan pemasangan alat bantu pada pasien yang kehilangan
                anggota gerak tubuh dan dilakukan oleh tenaga ahli profesional.
                Ortotik Prostetik memberikan pelayanan pengukuran, pemasangan,
                pengepasan, dan latihan untuk menggunakan ortose (alat bantu)
                maupun protese (alat ganti/ anggota gerak palsu).
              </p>
              <h3>Produk Unggulan Ortotik Prostetik RSO Soeharso Surakarta</h3>
              <div class="op-catalog shadow-sm">
                <div class="op-cat-col">
                  <div class="op-cat-head head-lower">Anggota Gerak Bawah</div>
                  <ul class="op-cat-list">
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Foot Abduction Brace (FAB)</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Ankle Foot Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Hinged Ankle Foot Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Ground Reaction Ankle Foot Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i><span>PTB AFO</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Knee Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Knee Ankle Foot Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Hip Abduction Brace</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Syme Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Trans Tibial Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Knee Disarticulation Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Trans Femoral Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Hip Disarticulation Prosthesis</span>
                    </li>
                  </ul>
                </div>
                <div class="op-cat-col">
                  <div class="op-cat-head head-upper">Anggota Gerak Atas</div>
                  <ul class="op-cat-list">
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Finger Splint</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Wrist Hand Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Elbow Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Humeri Orthosis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Robotic Hand</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Finger Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Wrist Disarticulation Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Trans Radial Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Elbow Disarticulation Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Trans Humeral Prosthesis</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Shoulder Disarticulation Prosthesis</span>
                    </li>
                  </ul>
                </div>
                <div class="op-cat-col">
                  <div class="op-cat-head head-spinal">Spinal Orthosis</div>
                  <ul class="op-cat-list">
                    <li><i class="bi bi-check-circle"></i><span>TLSO</span></li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Scoliosis Brace</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Jewett Brace</span>
                    </li>
                    <li>
                      <i class="bi bi-check-circle"></i
                      ><span>Knight Taylor Brace</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      </main>

    <footer id="footer" class="footer dark-background">
      </footer>

    <a
      href="#"
      id="scroll-top"
      class="scroll-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <div id="preloader"></div>

    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

    <script src="assets/js/main.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore-compat.js"></script>
    <script src="../config-firebase.js"></script>
    
    <script src="https://www.google.com/recaptcha/enterprise.js" async defer></script>
    
    <script>
      // --- KONFIGURASI FIREBASE ---
      let trackDb;
      try {
        trackDb = firebase.firestore();
      } catch (e) {
        console.error("Firebase Gagal diinisialisasi:", e);
      }

      // --- KONFIGURASI reCAPTCHA ---
      const RECAPTCHA_SITE_KEY = (window.RECAPTCHA_SITE_KEY || "6LeluLIrAAAAADhkOBCwPt_TLZ1CNrPJ4tB-oDZ6");
      let recaptchaWidgetId = null;

      // Fungsi untuk menunggu reCAPTCHA siap
      function waitForRecaptcha(timeoutMs = 8000) {
        return new Promise((resolve, reject) => {
          const start = Date.now();
          (function check() {
            if (
              typeof grecaptcha !== "undefined" &&
              grecaptcha.enterprise &&
              typeof grecaptcha.enterprise.render === "function"
            ) {
              return resolve();
            }
            if (Date.now() - start > timeoutMs) {
              return reject(new Error("reCAPTCHA gagal dimuat."));
            }
            setTimeout(check, 100);
          })();
        });
      }

      // Fungsi untuk merender reCAPTCHA saat halaman dimuat
      function initRecaptcha() {
          const recaptchaErr = document.getElementById("recaptcha-error");
          waitForRecaptcha()
            .then(() => {
                try {
                    if (recaptchaWidgetId === null) {
                        recaptchaWidgetId = grecaptcha.enterprise.render("recaptcha-container", {
                            'sitekey': RECAPTCHA_SITE_KEY,
                            'theme': 'light',
                            'size': 'normal',
                            'callback': function() { // Dipanggil saat user mencentang box
                               if (recaptchaErr) {
                                   recaptchaErr.style.display = "none";
                               }
                            },
                            'expired-callback': function() { // Dipanggil saat token kadaluarsa
                               if (recaptchaErr) {
                                   recaptchaErr.textContent = "Sesi reCAPTCHA kedaluwarsa. Mohon verifikasi ulang.";
                                   recaptchaErr.style.display = "block";
                               }
                            }
                        });
                    }
                } catch (renderErr) {
                    console.error("Gagal merender reCAPTCHA:", renderErr);
                    if (recaptchaErr) {
                        recaptchaErr.textContent = "Gagal memuat reCAPTCHA.";
                        recaptchaErr.style.display = "block";
                    }
                }
            })
            .catch((loadErr) => {
                console.error("Gagal memuat script reCAPTCHA:", loadErr);
                if (recaptchaErr) {
                    recaptchaErr.textContent = "reCAPTCHA tidak tersedia. Coba lagi.";
                    recaptchaErr.style.display = "block";
                }
            });
      }

      // Jalankan render reCAPTCHA setelah halaman selesai dimuat
      window.addEventListener('load', initRecaptcha);
      
      // --- LOGIKA FORM PENCARIAN ---
      async function trackByReg(event) {
        event.preventDefault(); // Mencegah form dari reload halaman
        
        const input = document.getElementById("regSearchInput");
        const reg = (input.value || "").trim();
        const trackErr = document.getElementById("track-error");
        const recaptchaErr = document.getElementById("recaptcha-error");
        
        // Sembunyikan pesan error sebelumnya
        trackErr.style.display = "none";
        recaptchaErr.style.display = "none";

        if (!reg) {
          return false; // Jangan lakukan apa-apa jika input kosong
        }

        // 1. Validasi Token reCAPTCHA
        const token = grecaptcha.enterprise.getResponse(recaptchaWidgetId);
        if (!token) {
          recaptchaErr.textContent = "Silakan centang reCAPTCHA untuk verifikasi.";
          recaptchaErr.style.display = "block";
          return false;
        }

        // 2. Lanjutkan ke pencarian data jika reCAPTCHA valid
        try {
          if (!trackDb) {
            trackErr.textContent = "Konfigurasi sistem belum siap.";
            trackErr.style.display = "block";
            return false;
          }

          const snap = await trackDb.collection("patients").doc(reg).get();
          if (!snap.exists) {
            trackErr.textContent = "No. order tidak ditemukan.";
            trackErr.style.display = "block";
            grecaptcha.enterprise.reset(recaptchaWidgetId); // Reset captcha setelah gagal
            return false;
          }

          const data = snap.data();
          if (!data.token) {
            trackErr.textContent = "Data pasien belum siap dilacak.";
            trackErr.style.display = "block";
            grecaptcha.enterprise.reset(recaptchaWidgetId); // Reset captcha
            return false;
          }

          // 3. Arahkan ke halaman pelacakan jika semua berhasil
          window.location.href = `../tracking.html?token=${encodeURIComponent(data.token)}`;

        } catch (err) {
          console.error("Terjadi kesalahan saat mencari data:", err);
          trackErr.textContent = "Terjadi kesalahan. Coba lagi.";
          trackErr.style.display = "block";
          grecaptcha.enterprise.reset(recaptchaWidgetId); // Reset captcha
        }

        return false;
      }
    </script>
  </body>
</html>
